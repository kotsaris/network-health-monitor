<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="Network Health Monitor"
           Manufacturer="Network Health Monitor"
           Version="1.0.0.0"
           UpgradeCode="A1B2C3D4-E5F6-7890-ABCD-EF1234567890">

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="Network Health Monitor" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentRef Id="StartMenuShortcut" />
      <ComponentRef Id="StartupShortcut" />
    </Feature>

    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="NetworkHealthMonitor">
        <Component Id="ProductComponents" Guid="B2C3D4E5-F6A7-8901-BCDE-F23456789012">
          <File Id="MainExecutable" Source="$(var.PublishDir)\NetworkHealthMonitor.exe" KeyPath="yes" />
          <File Id="DepsJson" Source="$(var.PublishDir)\NetworkHealthMonitor.deps.json" />
          <File Id="RuntimeConfig" Source="$(var.PublishDir)\NetworkHealthMonitor.runtimeconfig.json" />
          <File Id="MainDll" Source="$(var.PublishDir)\NetworkHealthMonitor.dll" />
        </Component>
      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="Network Health Monitor">
        <Component Id="StartMenuShortcut" Guid="C3D4E5F6-A7B8-9012-CDEF-345678901234">
          <Shortcut Id="ApplicationStartMenuShortcut"
                    Name="Network Health Monitor"
                    Description="Monitor network health"
                    Target="[INSTALLFOLDER]NetworkHealthMonitor.exe"
                    WorkingDirectory="INSTALLFOLDER" />
          <RemoveFolder Id="CleanUpShortCut" On="uninstall" />
          <RegistryValue Root="HKCU" Key="Software\NetworkHealthMonitor" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        </Component>
      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="StartupFolder">
      <Component Id="StartupShortcut" Guid="D4E5F6A7-B8C9-0123-DEF0-456789012345">
        <Shortcut Id="ApplicationStartupShortcut"
                  Name="Network Health Monitor"
                  Description="Monitor network health"
                  Target="[INSTALLFOLDER]NetworkHealthMonitor.exe"
                  WorkingDirectory="INSTALLFOLDER" />
        <RegistryValue Root="HKCU" Key="Software\NetworkHealthMonitor" Name="startup" Type="integer" Value="1" KeyPath="yes" />
      </Component>
    </StandardDirectory>

  </Package>
</Wix>
